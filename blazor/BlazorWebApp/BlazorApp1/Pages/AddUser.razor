@page "/addUser"
@using BlazorApp1.Components
@using BlazorApp1.Models
@using BlazorApp1.Services

@inject IService<Utilisateur> UtilisateurService

<h3>Ajouter un utilisateur</h3>

<UserForm Model="Model" OnSubmit="Submit" ButtonText="Ajouter un nouvel Utilisateur"></UserForm>

@code {
    [SupplyParameterFromForm] private Utilisateur? Model { get; set; } = new Utilisateur();
    [Inject] protected ToastService ToastService { get; set; }

    private async void Submit()
    {
        var result = await UtilisateurService.PostAsync("Utilisateurs", Model);
        if (result)
        {
            Console.WriteLine("Utilisateur ajouté");
            ToastService.Notify(new(ToastType.Success, "Succès !", "Utilisateur ajouté"));
        }
        else
        {
            Console.WriteLine("Erreur lors de l'ajout de l'utilisateur");
            ToastService.Notify(new(ToastType.Danger, "Erreur ajout", "Erreur lors de l'ajout de l'utilisateur"));
        }
    }

}